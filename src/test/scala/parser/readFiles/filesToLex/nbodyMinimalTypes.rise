nbody::N:Nat=>N.4xF32->N.4xF32->F32->F32->N.(4xF32,4xF32) --4xF32 for vec(4,f32)
nbody=\N:Nat=>\pos->\vel->\espSqr->\deltaT->
 join ( join ( mapWorkGroup 1 ( join ( mapWorkGroup 0 (
        \p1Chunk -> \newP1Chunk-> mapLocal 1 ( \bla-> mapLocal 0 (
            \p1A-> update (fst (fst p1A)) (fst (snd p1A)) deltaT (snd p1A)
          )(zip newP1Chunk bla) )(
          oclReduceSeq Local 
          (\accA->\p2A-> let (toLocal (mapLocal 1 (mapLocal 0 (\x1->x1))) p2A)
          (\p2Local -> mapLocal 1 (\accDim-> mapLocal 0 (\p1B -> oclReduceSeq Private (
                 \accB->\p2B-> calcAcc (fst (fst p1B)) p2B deltaT espSqr accB) (snd p1B) (fst accDim2)
              ) (zip newP1Chunk (snd (snd accDim)))) (zip p2Local accA)) )
          (mapLocal 1 (mapLocal 0 (\x2->x2)) (generate (vectorFromScalar 0))))
        (split 1N ( split 256N pos))) (split 256N)))(split N ( zip pos vel))))